/*! ArcGIS API for JavaScript 4.9 | Copyright (c) 2018 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
define(["esri-playground-js/utils/CurrentState","esri-playground-js/utils/mainUtils","esri-playground-js/utils/ObjectProvider","dijit/registry"],function(S,f,m,x){var e={},M=function(e){var t;return t=document.createElement(e.tag),e.data&&(t.innerHTML=e.data),e.class&&(t.className=e.class),e.id&&t.setAttribute("id",e.id),t},T=function(t){var e=t.node,a=document.createElement("ul");return t.config.properties.forEach(function(e){v({config:t.config,property:e,node:a,domId:t.domId,isList:!0,enableDelete:t.enableDelete})}),null==e&&(e=M({tag:"div"})),e.appendChild(a),e},v=function(n){var r,e,a,s=S.getInstance(),o=n.config,i=n.property,p=n.node,t=n.domId,d=n.enableDelete,c=n.isList;if(r=c?document.createElement("li"):M({tag:"div",class:n.class}),t&&r.setAttribute("data-domId",t),"Object"===i.type||"Array"===i.type||"Class"===i.type||"Color"===i.type){var l=M({tag:"div",class:"nested-property-container"});if(e=M({data:i.name,tag:"p",class:"nested-property-name"}),i.required){var u=M({data:"*",tag:"span"});e.appendChild(u)}var f=M({tag:"div"}),m=M({data:"expand",tag:"p",class:null,id:i.domId+"-TextID"});f.appendChild(m),l.appendChild(e),l.appendChild(f),r.appendChild(l),a=M({tag:"div",class:"modal-container"}),r.addEventListener("click",function(e){a.style.display="block";var t=document.getElementById("playArea").children[0].children[0];t.appendChild(a),t.scrollTop=0,t.style.overflow="hidden",e.stopPropagation()})}else{if(e=M({data:i.name,tag:"p",class:"property-name"}),i.required){u=M({data:"*",tag:"span"});e.appendChild(u)}r.appendChild(e),a=M({tag:"div",class:"property-value-container"}),r.className="flexer"}if("Number"===i.type)if(i.attributes&&i.attributes.min&&i.attributes.max){if((I=M({tag:"input",class:"property-value",id:i.domId+"-RangeID"})).setAttribute("type","range"),void 0!==i.default?(I.setAttribute("placeholder",Math.round(100*i.default)/100),I.value=Math.round(100*i.default)/100):I.setAttribute("placeholder","enter "+i.name),i.attributes)for(var v in i.attributes)I.setAttribute(v,i.attributes[v]);if(a.appendChild(I),(I=M({tag:"input",class:"property-value",id:i.domId+"-ID"})).setAttribute("type","number"),void 0!==i.default?(I.setAttribute("placeholder",Math.round(100*i.default)/100),I.value=Math.round(100*i.default)/100):I.setAttribute("placeholder","enter "+i.name),i.attributes)for(var v in i.attributes)I.setAttribute(v,i.attributes[v]);a.appendChild(I)}else{if((I=M({tag:"input",class:"property-value",id:i.domId+"-ID"})).setAttribute("type","number"),void 0!==i.default?(I.setAttribute("placeholder",Math.round(100*i.default)/100),I.value=Math.round(100*i.default)/100):I.setAttribute("placeholder","enter "+i.name),i.attributes)for(var v in i.attributes)I.setAttribute(v,i.attributes[v]);a.appendChild(I)}else if("Boolean"===i.type){var g=M({tag:"div",class:"checkbox-container"});(I=M({tag:"input",class:"property-value",id:i.domId+"-ID"})).setAttribute("type","checkbox"),i.default&&(I.checked=!0);var h=M({tag:"label"});h.setAttribute("for",i.domId+"-ID"),g.appendChild(I),g.appendChild(h),a.appendChild(g)}else if("String"===i.type)if(i.options){var b=M({tag:"SELECT",class:"property-value",id:i.domId+"-ID"});b.setAttribute("name",i.name);var y=M({data:"select "+i.name,tag:"option"});y.disabled=!0,y.selected=!0,y.style.background="#ecf0f1",b.appendChild(y),i.options.values.forEach(function(e){var t,a,d=M({tag:"option"});a="string"==typeof e?t=e:(t=e.name,e.value),d.innerHTML=t,d.setAttribute("value",a),i.default&&i.default===a&&(d.selected=!0),b.appendChild(d)}),a.appendChild(b)}else if(i.value){var C=M({data:i.value+" (default)",tag:"p",class:"property-value",id:i.domId+"-ID"});a.appendChild(C)}else{var I;(I=M({tag:"input",class:"property-value",id:i.domId+"-ID"})).setAttribute("type","text"),void 0!==i.default?I.setAttribute("placeholder",i.default):I.setAttribute("placeholder","enter "+i.name),a.appendChild(I)}else if("Color"===i.type){var A=i.domId+"-",j=M({tag:"div",class:"colorDiv",id:A+"HolderID"}),E=M({tag:"div",class:"property-value",id:A+"ID"});j.appendChild(E),H(r,a,i.name,E)}else if("Object"===i.type){var N=i.config||i,O=T({config:N});H(r,a,i.name,O)}else if("Array"===i.type){"Object"===(D=i.options).type?B(r,i,D,a):"Color"===D.type?q(r,i,a):"Number"===D.type&&P(r,i,a)}else if("Class"===i.type){N=i.config;var D=i.options;if(N){var k=T({config:N});H(r,a,i.name,k)}else D&&B(r,i,D,a)}if(r.appendChild(a),d){var L=M({tag:"i",class:"fa fa-trash-o"});r.appendChild(L),L.addEventListener("click",function(e){if(c){var a,t=s.statefulObject[o.name].slice(0),d=r.getAttribute("data-domId");o.properties.some(function(e,t){if(d===e.domId)return a=t,!0}),o.properties.splice(a,1),t.splice(a,1),s.statefulObject.set(o.name,t)}else n.selectNode.style.display="block",s.statefulObject.set(o.name,null);if(x.findWidgets(r).forEach(function(e){e.destroy(!0)}),p.removeChild(r),0===p.childNodes.length){var i=p.parentNode,l=i.parentNode;i.removeChild(p),l.removeChild(i)}e.stopPropagation()})}return p.appendChild(r),p},P=function(e,a,d){var i=S.getInstance(),t=M({tag:"div",class:"inputSelect-block"}),l=M({data:"Add",tag:"button"});t.appendChild(l),H(e,d,a.name,t),l.addEventListener("click",function(){var t=M({tag:"input",class:"property-value",id:a.domId+"-ID"});t.setAttribute("type","text"),t.setAttribute("placeholder","enter "+a.name),d.firstChild.childNodes[1].appendChild(t),t.addEventListener("change",function(){a.properties.push(t.value);var e=[t.value];i.statefulObject.set(a.name,e)})})},q=function(e,t,a){var d=M({tag:"div",class:"colorSelect-node",data:"select color"}),i=M({tag:"div"}),l=M({data:"Add",tag:"button"}),n=M({tag:"div",class:"colorSelect-block"});i.appendChild(d),i.appendChild(l),n.appendChild(i),H(e,a,t.name,n),d.addEventListener("click",function(){})},B=function(e,s,t,o){var p=S.getInstance(),c=M({tag:"SELECT"});c.setAttribute("name",s.domId),t.values.forEach(function(e){if("Class"===e.type)(t=M({data:e.className,tag:"option"})).setAttribute("value",e.location),c.appendChild(t);else if("Object"===e.type){var t;(t=M({data:e.name,tag:"option"})).setAttribute("value",e.name),c.setAttribute("data-type","Object"),c.appendChild(t)}});var a=M({data:"Add",tag:"button"}),u=M({tag:"div"}),d=M({tag:"div",class:"typeSelect-block"});u.appendChild(c),u.appendChild(a),d.appendChild(u),H(e,o,s.name,d),a.addEventListener("click",function(e){var t=c.value;if(t)if(s.properties){var a=c.getAttribute("data-type");"Object"===a?s.options.values.some(function(e){if(e.name===t)return n=e,!0}):n=f.parseConfig(require.toUrl("esri-playground-data")+"/"+t,!0);var d=s.domId+"-"+s.properties.length;if(g(n,d),"Object"===a?(r=n).domId=d:r={name:n.className,className:n.className,config:n,domId:d,type:"Class"},s.properties.push(r),1===s.properties.length){var i=T({config:s,domId:d,enableDelete:!0});o.firstChild.childNodes[1].appendChild(i);var l=[m.getStatefullObject(n,p.statefulObject)];p.statefulObject.set(s.name,l)}else{v({config:s,property:r,domId:d,node:o.firstChild.childNodes[1].childNodes[1].firstChild,isList:!0,enableDelete:!0}),(l=p.statefulObject[s.name].slice(0)).push(m.getStatefullObject(n,p.statefulObject)),p.statefulObject.set(s.name,l)}}else{d=s.domId;var n=f.parseConfig("esri-playground-data/"+t,!0);g(n,d),s.location=t,s.config=n,s.className=n.className;var r={name:n.className,type:"Class",config:n,className:n.className,domId:d};v({config:s,property:r,domId:d,node:o.firstChild.childNodes[1].firstChild,selectNode:u,class:"item",isList:!1,enableDelete:!0}),p.statefulObject.set(s.name,m.getStatefullObject(n,p.statefulObject)),u.style.display="none"}e.stopPropagation()})},H=function(a,d,e,t){var i=M({tag:"div",class:"modal"}),l=M({tag:"div",class:"header"}),n=M({data:e,tag:"p",class:"title"}),r=M({tag:"i",class:"fa fa-times"}),s=M({tag:"div",class:"body"});l.appendChild(n),l.appendChild(r),i.appendChild(l),s.appendChild(t),i.appendChild(s),r.addEventListener("click",function(e){d.style.display="none";var t=document.getElementById("playArea").children[0].children[0];t.removeChild(d),a.appendChild(d),1===t.children.length&&(t.style.overflow="auto"),e.stopPropagation()}),d.appendChild(i)},g=function(e,a){e.properties.forEach(function(e){var t=a+"-"+e.name;e.config?g(e.config,t):(e.domId=t,"Object"===e.type&&g(e,t))})};return e.getMainfragment=function(e){var t=M({tag:"div",class:"data-container"}),a=M({tag:"div",class:"data-block"});g(e,e.className);var d=T({config:e,node:a});t.appendChild(d);var i=document.createDocumentFragment();return i.appendChild(t),i},e.getIndexfragment=function(e){var n=document.createDocumentFragment();return e.constructor===Array&&e.forEach(function(e){var t,i,a=M({tag:"div",class:"modules-container"}),d=M({data:e.name,tag:"p",class:"title"}),l=(t=e.list,i=document.createElement("ul"),t.forEach(function(e){var t,a=document.createElement("li"),d=M({data:e.name,tag:"p"});a.setAttribute("data-config-loc",e.location),a.setAttribute("data-config-name",e.name),a.appendChild(d),e.message&&(t=M({tag:"i",class:"fa fa-exclamation-circle"}),e.error&&(t.style.color="#e74c3c"),a.setAttribute("data-tooltip",e.message),a.className="hasToolTip",d.appendChild(t)),i.appendChild(a)}),i);a.appendChild(d),a.appendChild(l),n.appendChild(a)}),n},e});
/*! ArcGIS API for JavaScript 4.9 | Copyright (c) 2018 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
define(["esri/widgets/ColorPicker","esri/widgets/support/colorUtils","esri-playground-js/utils/DataProvider","dojo/Stateful","dojo/_base/declare","dojo/dom"],function(I,w,e,t,n,E){var a={},r=n([t],{}),x=function(e){var g=new r,t=e.className||e.name;g.set("className",t);var b=e.properties;return b.forEach(function(a){var r=a.name,o=a.type,e=a.value,s=a.attributes,i=a.default,t=a.visibility,l=E.byId(a.domId+"-ID");if(g.set(r,null),"Number"===o||"String"===o){if("Number"===o&&s&&s.min&&s.max){var u=E.byId(a.domId+"-RangeID");u.addEventListener("input",function(){g.set(r,u.value)})}if(g.watch(r,function(e,t,n){if(l.value=i&&null===n?i:n,s&&s.min&&s.max&&(u.value=l.value),"url"===r){var a=new Image;a.addEventListener("load",function(){g.set("width",this.naturalWidth),g.set("height",this.naturalHeight)}),a.src=l.value}}),l.addEventListener("change",function(){if("Number"===o&&s&&l.value<s.min){var e=E.byId("msg");e.innerHTML=r+" cannot be less than "+s.min+"!";var t=new Event("errMsg");e.dispatchEvent(t),g.set(r,null)}else l.value==i?g.set(r,null):g.set(r,l.value);s&&s.min&&s.max&&(E.byId(a.domId+"-RangeID").value=l.value);if("url"===r){var n=new Image;n.addEventListener("load",function(){g.set("width",this.naturalWidth),g.set("height",this.naturalHeight)}),n.src=l.value}},!1),t){var n;b.forEach(function(e){e.name===t.name&&(n=e)});var d=E.byId(n.domId+"-ID"),c=l.parentNode.parentNode;d.value!==t.value&&(c.style.display="none"),d.addEventListener("change",function(){d.value===t.value?(c.style.display="-webkit-box",c.style.display="-moz-box",c.style.display="-ms-flexbox",c.style.display="-webkit-flex",c.style.display="flex",void 0!==i&&g.set(r,i)):(c.style.display="none",g.set(r,null))})}e&&g.set(r,e)}else if("Boolean"===o)g.watch(r,function(e,t,n){l.checked=n}),l.addEventListener("change",function(){l.checked?g.set(r,!0):g.set(r,!1)},!1);else if("Color"===o){if(y=E.byId(a.domId+"-TextID")){var f=new I({title:"color-picker",showRecentColors:!1,showTransparencySlider:!0,showSuggestedColors:!1,required:!0},l);f.startup();var v=i||[0,0,0,1];f.set("color",v),y.innerHTML="["+v+"]",y.style.background=f.get("color"),f.on("color-change",function(){var e=f.get("color"),t=w.getContrastingColor(e),n=e.toRgba();n[3]=Math.round(100*n[3])/100,v.every(function(e,t){return e===n[t]})?g.set(r,null):g.set(r,n),n.constructor===Array&&(n="["+n+"]"),y.innerHTML=n,y.style.background=e,y.style.color=t}),g.watch(r,function(e,t,n){null===n&&(n=v),f.set("color",n)})}}else if("Class"===o||"Object"===o){var h=a.config||a;if(h&&h.properties){g.set(r,x(h));var m=E.byId(a.domId+"-TextID"),y=[],p=g[r];h.properties.forEach(function(e){var t=e.default;null!=t?("number"==typeof t&&(t=Math.round(100*t)/100),t.constructor===Array&&(t="["+t+"]"),y.push(t)):y.push(e.name)}),m.innerHTML=y.join(", "),p.watch(function(){y=[],h.properties.forEach(function(e){var t=p[e.name]||e.default||e.name;"number"==typeof t&&(t=Math.round(100*t)/100),t.constructor===Array&&(t="["+t+"]"),y.push(t)}),m.innerHTML=y.join(", ")})}}}),g};return a.getStatefullObject=x,a.StatefulClass=r,a});